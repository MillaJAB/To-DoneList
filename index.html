<!DOCTYPE html>
<html lang="en">
<head>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">
	<style>
	table, th, td {
    	border: 1px solid black;
    	border-collapse: collapse;
	}
	th, td {
    	padding: 3px 10px 7px 10px;
	}
	.centerColumn {
		text-align: center;
	}

	input {
		margin-top: 10px;
	}
	button {
		margin-top: 10px;
	}
	form {
		border-style: solid;
		margin-top: 10px;
		width: 300px;
		padding: 10px;
		padding-left: 25px;
	}
	</style>
</head>

<body>

	<table id="taskTable">
  		<tr>
    		<th>Priority</th>
    		<th>Project</th>
    		<th>Task</th>
    		<th>Due</th>
    		<th>Time Est</th>
    		<th>Complete?</th>
  		</tr>
  		<tr class="centerColumn">
    		<td>1</td>
    		<td>Wordpress</td>
    		<td>Locate a SEO plugin</td>
    		<td>3/13</td>
    		<td>30 min</td>
    		<td><input type="checkbox"></td>
  		</tr>
  		<tr>
    		<td id="projectShiz">Eve</td>
    		<td id="taskShiz">Jackson</td>
    		<td>94</td>
  		</tr>
	</table>

<form>
	Project:
	<input id="projectField" type="text" name="Priority"><br>
	Task:
	<input id="taskField" type="text" name="Task"><br>
	Priority:
	<input id="radioBtn1" type="radio" name="priority" value="1"> 1
	<input id="radioBtn2" type="radio" name="priority" value="2"> 2
	<input id="radioBtn3" type="radio" name="priority" value="3"> 3
	<input id="radioBtn4" type="radio" name="priority" value="4"> 4<br>
	Due Date:
	<input id="datePicker" type="date" name="dueDate"><br>
	Time Estimate:
	<input id="timeEstimate" type="text" name="timeEst">

</form>
<button onclick="setThings()">Submit</button>

</body>
</html>

<script src="https://www.gstatic.com/firebasejs/4.11.0/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyAF_vhCFAmopW6O6-nsbxpT9EAx1wJVIjI",
    authDomain: "todonelist-5df2e.firebaseapp.com",
    databaseURL: "https://todonelist-5df2e.firebaseio.com",
    projectId: "todonelist-5df2e",
    storageBucket: "",
    messagingSenderId: "81191745304"
  };
  firebase.initializeApp(config);

var taskDataRef = firebase.database().ref("tasks");
taskDataRef.once("value")
	.then(function(snapshot) {
		snapshot.forEach(function(childSnapshot) {
			var key = childSnapshot.key;
			var childData = childSnapshot.val();

			var project_val = childSnapshot.val().project;
			var task_val = childSnapshot.val().taskName;
			//document.getElementById("projectShiz").append(project_val);
			//document.getElementById("taskShiz").innerHTML = task_val;
			createRow(project_val, task_val);
		})
	})


</script>

<script>
	// Get a reference to the database service
	var database = firebase.database();

	function writeNewTask(taskName, priority, project, dueDate, timeEstimate) {
  		firebase.database().ref('tasks/' + taskName).set({
  			 priority: priority, 
   			 project: project,
    		 taskName: taskName,
   			 dueDate : dueDate,
   			 timeEstimate: timeEstimate
 	 	});
	}

// Need to check if things are empty. Bug deletes database if things are left empty
	function setThings() {
		var taskText = document.getElementById("taskField").value;
		var projectText = document.getElementById("projectField").value;
		var datePicked = document.getElementById("datePicker").value;
		var timeEstimate = document.getElementById("timeEstimate").value;
		var priorityPicked = checkRadioButtons();
		//var prioritySelect = document.getElementsByClassName("priorityRadioBtn").value;
		writeNewTask(taskText, priorityPicked, projectText, datePicked, timeEstimate)
		clearFields();
	}

	function clearFields() {
		document.getElementById("projectField").value = "";
		document.getElementById("taskField").value = "";
		document.getElementById("datePicker").value = "";
		document.getElementById("timeEstimate").value = "";
		for (var i = 1; i <= 4; i++) {
			document.getElementById("radioBtn" + i).checked = false;
		}
	}

	function checkRadioButtons() {
		for (var i = 1; i <= 4; i++) {
			if (document.getElementById("radioBtn" + i).checked) {
				return document.getElementById("radioBtn" + i).value;
			}
		}
	}

	function createRow(project, task) {
		var table = document.getElementById("taskTable");
		var row = table.insertRow(1);
		var cell1 = row.insertCell(0);
		var cell2 = row.insertCell(1);
		cell1.innerHTML = project;
		cell2.innerHTML = task;
	}

</script>
